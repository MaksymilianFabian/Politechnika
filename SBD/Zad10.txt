1. CREATE VIEW ASYSTENCI (NAZWISKO, PLACA, STAZ) AS
SELECT 
NAZWISKO, 
PLACA_POD+PLACA_DOD,
'lat: ' || FLOOR(MONTHS_BETWEEN(TO_DATE('1/01/2024','DD/MM/YYYY'), ZATRUDNIONY) / 12) || ', miesiÄ™cy: ' || MOD(MONTHS_BETWEEN(TO_DATE('1/01/2024','DD/MM/YYYY'), ZATRUDNIONY), 12)
FROM PRACOWNICY
WHERE ETAT='ASYSTENT';

2. CREATE VIEW PLACE (ID_ZESP, SREDNIA, MINIMUM, MAXIMUM, FUNDUSZ, L_PENSJI, L_DODATKOW) AS
SELECT 
ID_ZESP,
AVG(PLACA_POD+NVL(PLACA_DOD,0)),
MIN(PLACA_POD+NVL(PLACA_DOD,0)),
MAX(PLACA_POD+NVL(PLACA_DOD,0)),
SUM(PLACA_POD+NVL(PLACA_DOD,0)),
COUNT(PLACA_POD),
COUNT(PLACA_DOD)
FROM PRACOWNICY
GROUP BY ID_ZESP;

SELECT * FROM PLACE
ORDER BY ID_ZESP;

3. SELECT P.NAZWISKO, P.PLACA_POD+NVL(P.PLACA_DOD,0) AS PLACA_RAZEM
FROM PRACOWNICY P JOIN PLACE PL
ON P.ID_ZESP=PL.ID_ZESP
WHERE P.PLACA_POD+NVL(P.PLACA_DOD,0) < PL.SREDNIA
ORDER BY NAZWISKO;

4. CREATE VIEW PLACE_MINIMALNE AS
SELECT
ID_PRAC, NAZWISKO, ETAT, PLACA_POD
FROM PRACOWNICY
WHERE PLACA_POD < 700
WITH CHECK OPTION CONSTRAINT naruszono_limit;

5. UPDATE PLACE_MINIMALNE
SET PLACA_POD=800
WHERE NAZWISKO='HAPKE';

6. CREATE VIEW PRAC_SZEF (ID_PRAC,ID_SZEFA,PRACOWNIK,ETAT,SZEF) AS
SELECT P.ID_PRAC, P.ID_SZEFA, P.NAZWISKO AS PRACOWNIK, P.ETAT, S.NAZWISKO AS SZEF
FROM PRACOWNICY P LEFT JOIN PRACOWNICY S
ON P.ID_SZEFA=S.ID_PRAC
ORDER BY PRACOWNIK;

INSERT INTO PRAC_SZEF (ID_PRAC, ID_SZEFA, PRACOWNIK, ETAT)
VALUES (280,150, 'MORZY','ASYSTENT'); 

UPDATE PRAC_SZEF SET ID_SZEFA = 130 WHERE ID_PRAC = 280; 

DELETE FROM PRAC_SZEF WHERE ID_PRAC = 280; 

7. CREATE VIEW ZAROBKI AS
SELECT P.ID_PRAC, P.NAZWISKO, P.ETAT, P.PLACA_POD
FROM PRACOWNICY P
WHERE P.PLACA_POD <= (SELECT S.PLACA_POD FROM PRACOWNICY S WHERE P.ID_SZEFA = S.ID_PRAC)
WITH CHECK OPTION;

8. SELECT VIEW_NAME, TEXT FROM USER_VIEWS;

9. SELECT COLUMN_NAME, UPDATABLE, INSERTABLE, DELETABLE FROM USER_UPDATABLE_COLUMNS
WHERE TABLE_NAME='PRAC_SZEF';